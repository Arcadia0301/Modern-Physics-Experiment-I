import numpy as np

# 峰值数据
peak_data = {
    1: (161.79, 459.98), 2: (239.14, 572.40), 3: (316.48, 433.78), 4: (393.82, 512.18),
    5: (467.64, 267.91), 6: (520.38, 104.00), 7: (552.02, 136.05), 8: (762.95, 128.04),
    9: (847.32, 296.26), 10: (917.63, 488.26), 11: (991.46, 464.47), 12: (1068.80, 583.54),
    13: (1142.62, 440.08), 14: (1223.48, 520.43), 15: (1297.31, 273.12), 16: (1350.04, 108.00),
    17: (1381.68, 136.00), 18: (1592.61, 132.34), 19: (1676.98, 300.04), 20: (1747.29, 499.85),
    21: (1821.12, 472.07), 22: (1898.46, 588.39), 23: (1972.29, 443.97), 24: (2049.63, 520.32),
    25: (2098.84, 232.00), 26: (2123.45, 272.03), 27: (2176.19, 108.00), 28: (2183.22, 112.36),
    29: (2204.31, 136.03), 30: (2422.27, 132.02), 31: (2443.36, 116.40), 32: (2499.61, 300.33),
    33: (2573.44, 496.29), 34: (2643.75, 472.15), 35: (2724.61, 588.25), 36: (2794.92, 448.07),
    37: (2875.77, 519.92), 38: (2946.08, 272.01), 39: (3002.33, 108.01), 40: (3033.97, 136.00),
    41: (3237.87, 128.11), 42: (3262.48, 116.40), 43: (3318.73, 296.25), 44: (3392.55, 492.40),
    45: (3466.38, 472.23), 46: (3543.72, 588.38)
}

# 子峰对应关系
subpeak_mapping = {
    1: [8, 18, 30],
    2: [9, 19, 32],
    3: [10, 20, 33],
    4: [11, 21, 34],
    5: [12, 22, 35],  # 参考峰
    6: [13, 23, 36],
    7: [14, 24, 37],
    8: [15, 26, 38],
    9: [17, 29, 40]
}

# 计算每个子峰到子峰5的x坐标差
subpeak5_x = [peak_data[peak_num][0] for peak_num in subpeak_mapping[5]]
print("子峰5的x坐标:", subpeak5_x)

results = {}
for subpeak_num, peak_indices in subpeak_mapping.items():
    if subpeak_num == 5:
        continue  # 跳过自身

    x_differences = []
    for i, peak_idx in enumerate(peak_indices):
        # 计算与对应干涉序的子峰5的差值
        diff = peak_data[peak_idx][0] - subpeak5_x[i]
        x_differences.append(diff)

    avg_difference = np.mean(x_differences)
    std_difference = np.std(x_differences)

    results[subpeak_num] = {
        'x_differences': x_differences,
        'average': avg_difference,
        'std': std_difference
    }

# 输出结果
print("\n各子峰距离子峰5的x坐标差平均值:")
print("子峰序号 | 干涉序1差值 | 干涉序2差值 | 干涉序3差值 | 平均值 | 标准差")
print("-" * 65)
for subpeak_num in sorted(results.keys()):
    data = results[subpeak_num]
    diffs = [f"{d:8.3f}" for d in data['x_differences']]
    print(f"子峰 {subpeak_num}  | {diffs[0]} | {diffs[1]} | {diffs[2]} | {data['average']:6.2f} | {data['std']:5.2f}")

# 子峰5自身的信息
print(f"\n子峰5参考坐标: {subpeak5_x}")